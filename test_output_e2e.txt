C:\Users\mateu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pytest_asyncio\plugin.py:208: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))
============================= test session starts =============================
platform win32 -- Python 3.13.9, pytest-8.3.4, pluggy-1.6.0 -- C:\Users\mateu\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\mateu\OneDrive\Documentos\fc26-career-analyzer
plugins: anyio-4.11.0, asyncio-0.24.0, cov-6.0.0
asyncio: mode=Mode.STRICT, default_loop_scope=None
collecting ... collected 1 item

tests/test_llm_integration.py::TestEndToEndQuery::test_full_query_pipeline ERROR [100%]

=================================== ERRORS ====================================
________ ERROR at setup of TestEndToEndQuery.test_full_query_pipeline _________

db_session = <sqlalchemy.orm.session.Session object at 0x0000027047F63A10>

    @pytest.fixture
    def test_db_with_players(db_session):
        """Fixture that provides DB with test players."""
        from src.database.models import Player
    
        players = [
>           Player(
                playerid=1,
                firstname="Cristiano",
                lastname="Ronaldo",
                commonname="Cristiano Ronaldo",
                overallrating=89,
                potential=89,
                age=39,
                preferredposition1=14,  # ST
            ),
            Player(
                playerid=2,
                firstname="Kylian",
                lastname="MbappÚ",
                commonname="Kylian MbappÚ",
                overallrating=92,
                potential=95,
                age=25,
                preferredposition1=12,  # LW
            ),
        ]

tests\test_llm_integration.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
<string>:4: in __init__
    ???
..\..\..\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\sqlalchemy\orm\state.py:571: in _initialize_instance
    with util.safe_reraise():
..\..\..\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
..\..\..\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\sqlalchemy\orm\state.py:569: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Player Player 1 (OVR ?, ?)>
kwargs = {'age': 39, 'commonname': 'Cristiano Ronaldo', 'firstname': 'Cristiano', 'lastname': 'Ronaldo', ...}
cls_ = <class 'src.database.models.player.Player'>, k = 'lastname'

    def _declarative_constructor(self: Any, **kwargs: Any) -> None:
        """A simple constructor that allows initialization from kwargs.
    
        Sets attributes on the constructed instance using the names and
        values in ``kwargs``.
    
        Only keys that are present as
        attributes of the instance's class are allowed. These could be,
        for example, any mapped columns or relationships.
        """
        cls_ = type(self)
        for k in kwargs:
            if not hasattr(cls_, k):
>               raise TypeError(
                    "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
                )
E               TypeError: 'lastname' is an invalid keyword argument for Player

..\..\..\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\sqlalchemy\orm\decl_base.py:2177: TypeError
============================== warnings summary ===============================
src\database\models\base.py:27
  C:\Users\mateu\OneDrive\Documentos\fc26-career-analyzer\src\database\models\base.py:27: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

tests\test_llm_integration.py:139
  C:\Users\mateu\OneDrive\Documentos\fc26-career-analyzer\tests\test_llm_integration.py:139: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
ERROR tests/test_llm_integration.py::TestEndToEndQuery::test_full_query_pipeline
======================== 2 warnings, 1 error in 5.41s =========================
